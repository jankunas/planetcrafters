<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Fira+Code|Montserrat+Subrayada:700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/side-nav-left.css">
    <link rel="stylesheet" href="styles/galaxy.css">
    <link rel="stylesheet" href="styles/modal.css">
    <script src="matchedPlanets.js"></script>
    <script src="state.js"></script>
    <script src="mainStar.js"></script>
    <script src="functions.js"></script>

    <!--Sidebar-->
    <link rel="stylesheet" type="text/css" href="styles/sidebar.css">
    <link rel="stylesheet" type="text/css" href="styles/slider.css">
    <link rel="stylesheet" type="text/css" href="styles/switch.css">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
</head>


<div>
    <div id="first-window">
        <div id="heading">
            <h1>Planet Crafters</h1>
            <p>Choose a Star</p>
        </div>
        <div class="stars"></div>
        <div class="twinkling"></div>
        <div style="text-align:center">
            <a href="#" data-toggle="modal" data-target="#largeModal">
                <span id="mainStar" class="dot"></span>
            </a>
        </div>

        <div class="modal fade" id="largeModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="myModalLabel">Proxima Centauri</h4>
                    </div>
                    <div class="modal-body">
                        <h3>
                            Proxima Centauri is a small, low-mass star located 4.244 light-years (1.301 pc) away from the Sun in the
                            southern constellation of Centaurus.
                            <br>
                            <b>Class</b>: M
                            <br>
                            <b>Color</b>: Red
                            <br>
                            <b>Age</b>: 4.85 billion years
                            <br>
                            <b>Luminosity</b>: 588 times less powerful than Sun
                        </h3>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick='craftPlanet()'>Craft your planet</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="failModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="failLabel">Your planet is not habitable</h4>
                    </div>
                    <div class="modal-body">
                        <h3>
                            It is thought that if the planet is too hot, water will boil and the atmosphere
                            (including water vapour) might escape from the planet.
                            Modify your planet features and try again!
                        </h3>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Try again</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="lostModal" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="lostLabel">Game over</h4>
                        </div>
                        <div class="modal-body">
                            <h3>
                                You journey to colonize the galaxy has came to an abrupt end.
                            </h3>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick='startOver()'>Start over</button>
                        </div>
                    </div>
                </div>
            </div>

        <div class="modal fade" id="successModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="successLabel">Congratulations! You have created a wonderful planet to live in!</h4>
                    </div>
                    <div class="modal-body">
                        <h3>
                                Your planet is in optimal distance from a host star considering its albedo and the amount of greenhouse gas. It is thought that water is essential for life to exist. The temperature in your planet is in optimal range for water to remain in liquid form.
                                Continue your journey by experimenting with other star systems.
                        </h3>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick='nextPlanet()'>To the next planet!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sidenav" id="sidenav" hidden>
            <div class="sidecontainer">
                <i class="fas fa-heart live heart1" id="heart1" style="font-size:48px;color:red;"></i>
                <i class="fas fa-heart live heart2" id="heart2" style="font-size:48px;color:red;"></i>
                <i class="fas fa-heart live heart3" id="heart3" style="font-size:48px;color:red;"></i>
                <br>
                <h2>Craft a Planet!</h2>
                <div>
                    <h3 class="inputValue">Planet Mass</h3>
                    <h4 class="inputValue"><span id="massValue"></span><span> Earth mass</span></h4>
                    <input id="massInput" type="range" min="0.0002" max="3000" step="0.02" class="slider" >
                </div>

                <div>
                    <h3 class="inputValue">Planet radius</h3>
                    <div class="inputValue">
                        <h3><span id="radiusValue"></span><span> Earth radius</span></h3>
                    </div>
                    <input id="radiusInput" type="range" min="0.5" max="76" step="0.5" class="slider" >
                    </div>
                <div>

                <div>
                    <h3 class="inputValue">Orbit</h3>
                    <div class="inputValue">
                        <h3><span id="orbitValue"></span><span> x10^-3 Astronomical units(AU)</span></h3>
                    </div>
                    <input id="orbitInput" type="range" min="8" max="69" step="5" class="slider" >
                    </div>

                <div>
                    <h3 class="inputValue">Albedo</h3>
                    <div class="inputValue">
                        <h3 id="albedoValue"></h3>
                    </div>
                    <label class="switch">
                        <input id="albedoInput" type="checkbox">
                        <span class="sliderswitch round"></span>
                    </label>
                </div>

                <div>
                    <h3 class="inputValue">Greenhouse gas</h3>
                    <div class="inputValue">
                        <h3 id="gasValue"></h3>
                    </div>
                    <label class="switch">
                        <input id="gasInput" type="checkbox">
                        <span class="sliderswitch round"></span>
                    </label>
                </div>

                <br>
                <button class="button button4" onclick='inhabitPlanet()'>Inhabit the planet</button>
            </div>
        </div>
</div>
<div class="side-nav-left" id="side-nav-left" hidden>
        <div class="sidecontainer">
            <h2 id="planets-found">Number of planets found: 0</h2>
            <h3>Hey! Did you know that a planet with a similar mass and radius was already discovered by humans. Check it out</h3>
            <p><b>HIP 65426 b</b> is 385 light-years from Earth. It was discovered on 6 July 2017 by the Max Planck Institute for Astronomy using the Spectro-Polarimetric High-Contrast Exoplanet Research (SPHERE) instrument belonging to the European Southern Observatory (ESO).
                HIP 65426 b is around 14 million years old, and was expected to still have a debris disk. However, it doesn't have a debris disk, despite its young age, causing it to not fit current models for planetary formation. It is around 92 AU from its parent star, with a possible dusty atmosphere.
                <br>
                HIP 65426 b is 2860 times heavier than Earth. Did you know that planets that are 10 times the mass of Earth will have enough gravity to suck up the hydrogen and helium surrounding it as it is forming and become a gas giant?
            </p>
        </div>
    </div>
</div>

<canvas id="canvas"></canvas>
<script src="scripts.js"></script>

<script>
        var defaults = {
            mass: 0.0002,
            radius: 0.5,
            orbit: 8,
            albedo: false,
            gas: false,
        }

        var lives = 3;

        var massValue = document.getElementById("massValue");
        var massInput = document.getElementById("massInput");
        var radiusValue = document.getElementById("radiusValue");
        var radiusInput = document.getElementById("radiusInput");
        var orbitValue = document.getElementById("orbitValue");
        var orbitInput = document.getElementById("orbitInput");
        var albedoValue = document.getElementById("albedoValue");
        var albedoInput = document.getElementById("albedoInput");
        var gasValue = document.getElementById("gasValue");
        var gasInput = document.getElementById("gasInput");

        massInput.oninput = function() {
            massValue.innerHTML = this.value;
        }
        radiusInput.oninput = function() {
            radiusValue.innerHTML = this.value;
        }
        orbitInput.oninput = function() {
            orbitValue.innerHTML = this.value;
            changeOrbit(this.value);
        }
        albedoInput.oninput = function() {
            albedoValue.innerHTML = this.checked ? "High" : "Low";
        }
        gasInput.oninput = function() {
            gasValue.innerHTML = this.checked ? "High" : "Low";
        }

        function resetToDefaults() {
            massValue.innerHTML  = defaults.mass;
            massInput.value = defaults.mass;

            radiusValue.innerHTML  = defaults.radius;
            radiusInput.value = defaults.radius;

            orbitValue.innerHTML  = defaults.orbit;
            orbitInput.value = defaults.orbit;

            albedoInput.value = defaults.albedo;
            albedoValue.innerHTML = defaults.albedo ? "High" : "Low";

            gasInput.value = defaults.gas;
            gasValue.innerHTML = defaults.gas ? "High" : "Low";

            lives = 3;

            $("#heart1").show();
            $("#heart2").show();
            $("#heart3").show();
        }

        resetToDefaults();

        function inhabitPlanet() {
            if (orbitInput.value > 18 && orbitInput.value < 58) {
                showSuccessModal();
            } else if (orbitInput.value == 18 && albedoInput.checked && !gasInput.checked) {
                showSuccessModal();
            } else if (orbitInput.value == 58 && !albedoInput.checked && gasInput.checked) {
                showSuccessModal();
            } else {
                showFailModal();
            }
            handleLeftSideBar();
        };

        //Modals
        function showSuccessModal() {
            $("#successModal").modal('show');
            $("#successModal").appendTo("body");
        }

        function showFailModal() {
            decreaseLives();
            if (lives > 0) {
                $("#failModal").modal('show');
                $("#failModal").appendTo("body");
            }
        }

        function gameOver() {
            $("#lostModal").modal('show');
            $("#lostModal").appendTo("body");
        }

        $('#lostModal').on('hide.bs.modal', function(e){
            startOver();
        });

        $('#successModal').on('hide.bs.modal', function(e){
            nextPlanet();
        });

        function decreaseLives() {
            if (lives > 0) {
                lives = lives -1;
            }
            switch(lives) {
                case 2:
                    $("#heart1").hide();
                    break;
                case 1:
                    $("#heart1").hide();
                    $("#heart2").hide();
                    break;
                case 0:
                    $("#heart1").hide();
                    $("#heart2").hide();
                    $("#heart3").hide();
                    gameOver();
                    break;
                default:
                    // code block
            }
        }

        function nextPlanet() {
            $("#matched-planets").fadeOut();
            $('#sidenav').fadeOut();
            $('#side-nav-left').fadeOut();
            $("#canvas").fadeOut(1000, function () {
                $('#first-window').fadeIn(1500);
                resetToDefaults();
                updateMatchedPlanets(0);
            })
        }

        function startOver() {
            nextPlanet();
        }

        function handleLeftSideBar() {
            if (isSimilarPlanetFound()) {
                updateMatchedPlanets(1);
                $('#side-nav-left').fadeIn(1500);
            } else {
                $('#side-nav-left').fadeOut(300);
            }
        }

        function isSimilarPlanetFound() {
            var massValue = $("#massValue").text();
            var radiusValue = $("#radiusValue").text();
            return (massValue > 2500 && massValue < 3000) && (radiusValue > 13 && radiusValue < 19);
        }
    </script>








